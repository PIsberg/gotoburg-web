<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GotoBurg Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen p-8">
  <div class="max-w-2xl mx-auto bg-white p-8 rounded shadow-lg">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-2xl font-bold text-gray-800">Skapa ny artikel</h1>
      <span class="text-sm bg-blue-100 text-blue-800 px-3 py-1 rounded-full">Admin Panel</span>
    </div>

    <form id="articleForm" class="space-y-6">
      
      <!-- Title -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Rubrik</label>
        <input type="text" id="title" required
          class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"
          placeholder="T.ex. Nytt badhus öppnar i hamnen">
      </div>

      <div class="grid grid-cols-2 gap-4">
        <!-- Category -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Kategori</label>
          <select id="category" required
            class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
            <option value="Mat & Dryck">Mat & Dryck</option>
            <option value="Natur">Natur</option>
            <option value="Arbete">Arbete</option>
            <option value="Aktiviteter">Aktiviteter</option>
          </select>
        </div>
        
        <!-- Author -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Författare</label>
          <input type="text" id="author" required
            class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"
            placeholder="T.ex. Lars Westkust">
        </div>
      </div>

      <!-- Excerpt -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Ingress (Kort sammanfattning)</label>
        <textarea id="excerpt" rows="2" required
          class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"
          placeholder="Detta syns på startsidan..."></textarea>
      </div>

      <!-- Image -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Bild URL</label>
        <input type="url" id="imageUrl" 
          class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"
          placeholder="Lämna tomt för slumpmässig bild">
      </div>

      <!-- Content -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Artikelinnehåll</label>
        <p class="text-xs text-gray-500 mb-2">Tryck Enter för att skapa nya stycken.</p>
        <textarea id="content" rows="10" required
          class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"
          placeholder="Skriv din artikel här..."></textarea>
      </div>

      <button type="submit" 
        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded transition-colors">
        Publicera Artikel
      </button>
    </form>
  </div>

  <script>
    document.getElementById('articleForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const btn = e.target.querySelector('button');
      const originalText = btn.innerText;
      btn.innerText = 'Sparar...';
      btn.disabled = true;

      const data = {
        title: document.getElementById('title').value,
        category: document.getElementById('category').value,
        author: document.getElementById('author').value,
        excerpt: document.getElementById('excerpt').value,
        imageUrl: document.getElementById('imageUrl').value,
        content: document.getElementById('content').value
      };

      try {
        const response = await fetch('/api/articles', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        if (response.ok) {
          alert('Artikel sparad!');
          e.target.reset();
        } else {
          alert('Något gick fel.');
        }
      } catch (err) {
        console.error(err);
        alert('Kunde inte nå servern.');
      } finally {
        btn.innerText = originalText;
        btn.disabled = false;
      }
    });
  </script>
</body>
</html>
